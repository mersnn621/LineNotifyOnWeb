<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LineNotify</title>
  </head>
  <body>
    <form method="post" id="form">
      <label for="token">Token</label>
      <input type="text" name="Token" id="token" />
      <br />
      <label for="mes">メッセージ</label>
      <input type="text" name="Message" id="mes" />
      <button type="button"  id="submit">送信</button>
    </form>
    <script>
            const submit = document.getElementById("submit");
            const token = document.getElementById("token");
            const mes = document.getElementById("mes")

            //Token自動入力
            let url = new URL(window.location.href);
            let params = url.searchParams;
            token.value = params.get("token");
            form.setAttribute("action", location.href);

            //ボタン無効化
            submit.addEventListener("click", () => {
              submit.disabled  = true;
              setTimeout(function () {
                submit.disled = false;
              }, 5000);
            });

            //送信
            submit.addEventListener("click", function () {
              const requestBody = {
                token: token.value,
                message: mes.value
              };

            fetch("/", {
              method: "POST",
              headers: {
                 'Content-Type': 'application/json'
              },
              body: JSON.stringify(requestBody),
            });
            });
    </script>
  </body>
</html>
